package com.coinwallet.common.util;import com.coinwallet.common.exception.InvalidArgumentException;import com.coinwallet.common.web3j.utils.HttpRequestUtil;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import org.springframework.stereotype.Service;import javax.servlet.http.HttpServletRequest;import java.security.DigestException;/** * Created by luyangjian on 2017/9/26. */@Servicepublic class AESAPIService {    private static Logger logger = LoggerFactory.getLogger(AESAPIService.class);    public String getAESDecodeStr(AesReq aesReq, HttpServletRequest request) throws DigestException, InvalidArgumentException {        String version = HttpRequestUtil.getVersion(request).toString();        String platform = HttpRequestUtil.getPlatform(request);        String versionAfterThree = version.substring(version.length() - 3, version.length());        APIEncryptHelper apiEncryptHelper = new APIEncryptHelper(version, platform);        String[] aesStr = apiEncryptHelper.decode(aesReq.getValue()).split("&");        String aesReqStr = aesStr[0];       String sign = aesStr[1];       if (!sign.equalsIgnoreCase(Sha1.SHA1(aesReqStr, versionAfterThree, platform)))            throw new InvalidArgumentException("===aes sign error======");        return aesReqStr;    }}